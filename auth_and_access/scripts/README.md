# Различные скрипты для извлечения информации из Yandex Cloud

# Описание
Скрипты выкладываются по мере разработки. Язык программирования и среда выполнения могут различатся в зависимости от конкретной истории разработки каждого скрипта.

# Пререквизиты для всех скриптов
## Установка YC CLI
Для развёртывания рабочего окружения установим инструмент `Yandex Cloud CLI (yc)` на свой компьютер (подробная [инструкция](https://cloud.yandex.ru/docs/cli/operations/install-cli#interactive)).

## Необходимые разрешения
Как правило, скрипты только запрашивают информацию, поэтому для их работы, как минимум, необходима роль viewer на объекты соответствующего уровня (organization, cloud, folder).

## Дополнительная информация
Для некоторых скриптов в самом начале необходимо установить переменную, которая в явном виде прописывает ID верхнего контейнера (как правило, организации).
Для получения ID организации можно воспользоваться GUI или yc:
```Python
yc organization-manager organization list
```

# ListIPs - вывод всех внешних IP ардесов для организации
## Инструкция
- Получаем ID нужной организации.
- Записываем значение ID в значение переменной (первая строка скрипта)
- Запускаем скрипт

## Формат вывода
Скрипт выводит по одному внешнему IPv4 адресу на строке.


# yc_list_roles - вывод ролей для пользователей/групп/сервисных учеток. Роли выводятся для каждного урованя иерархии (organization/cloud/folder)
## Инструкция
- Задайте имя файла, куда будет выводится результат.
- Оцените количество пользоватетей в вашей организации - команда запроса информации по пользователям по умолчанию возвращает 1000 строк, если в вашей организации большее количество, установите параметр max_user_count в количество, гарантировано превышающее количество ваших пользователей (по умолчанию в скрипте это 25000).
- При необходимости можно указать фильтр по сканируемым организциям и облакам. Фильтр используется при установки соответствующей переменной в $true (например, $use_orgs_filter=$true)
- Запускаем скрипт

## Формат вывода
Скрипт выводит CSV файл (разделители - точка с запятой). Формат строки: "Level;OrgName;OrgID;CloudName;CloudID;FolderName;FolderID;Role;SubjectType;SubjectID;SubjectName". Данный файл рекомендуется анализировать в Excel или других средствах анализа таблиц (например, Data Lens).








